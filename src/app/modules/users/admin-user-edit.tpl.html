<!-- User Details -->
<form name="userForm" ng-submit="saveUser()" id="userForm">

    <nav class="navbar navbar-fixed-top" id="preslog_sub_nav">
        <div class="navbar-inner">
            <div class="container-fluid">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <h2>Edit User</h2>

                <div class="nav-collapse collapse navbar-responsive-collapse">
                    <ul class="nav pull-right">
                        <li>
                            <button type="submit" class="btn btn-success" ng-disabled="userForm.$invalid"><i class="icon icon-ok"></i> Save Changes</button>
                            <button type="button" class="btn btn-danger" ng-click="deleteUser()" ng-show="!{{user.deleted}}" ng-confirm-click="Are you sure you want to delete this user?"><i class="icon icon-remove"></i> Delete User</button>
                        </li>
                    </ul>
                </div><!-- /.nav-collapse -->
            </div>
        </div><!-- /navbar-inner -->
    </nav>

    <div class="container-fluid" id="preslog_my_profile">
        <div class="row-fluid">
            <div class="span12 form-horizontal">

                <p>Use the form below to modify the users details.</p>

                <!-- Names -->
                <div class="control-group" ng-class="{error: userForm.firstName.$invalid}">
                    <label class="control-label" for="inputFirstname">First Name</label>
                    <div class="controls">
                        <input type="text"
                               id="inputFirstname"
                               name="firstName"
                               placeholder="First name.."
                               ng-model="user.firstName"
                               required />
                        <span class="help-inline" ng-show="userForm.firstName.$error.required">You must supply a first name.</span>
                    </div>
                </div>
                <div class="control-group" ng-class="{error: userForm.lastName.$invalid}">
                    <label class="control-label" for="inputLastname">Last Name</label>
                    <div class="controls">
                        <input type="text"
                               id="inputLastname"
                               name="lastName"
                               placeholder="Last name.."
                               ng-model="user.lastName"
                               required />
                        <span class="help-inline" ng-show="userForm.lastName.$error.required">You must supply a last name.</span>
                    </div>
                </div>

                <!-- Contact -->
                <div class="control-group" ng-class="{error: userForm.email.$invalid}">
                    <label class="control-label" for="inputEmail">Email Address</label>
                    <div class="controls">
                        <input type="email"
                               id="inputEmail"
                               name="email"
                               required placeholder="Email address.."
                               ng-model="user.email"
                               tooltip="Email address changes by administrators do not require confirmation by users and will be applied immediately."
                               tooltip-placement="right" />
                        <span class="help-inline" ng-show="userForm.email.$error.required">You must supply an email address.</span>
                        <span class="help-inline" ng-show="userForm.email.$error.email">Email address in invalid.</span>
                    </div>
                </div>


                <!-- Passwords -->
                <div class="control-group" ng-class="{error: userForm.passwordConfirm.$invalid}">
                    <label class="control-label" for="inputPassword">Password</label>
                    <div class="controls">
                        <input type="text"
                               id="inputPassword"
                               name="password"
                               placeholder="enter new password.."
                               ng-model="user.password" />
                        <span class="help-inline" ng-show="userForm.passwordConfirm.$error.passwordConfirm">Passwords do not match</span>
                    </div>
                </div>
                <div class="control-group" ng-class="{error: userForm.passwordConfirm.$invalid}">
                    <label class="control-label" for="inputPassword2">Confirm Password</label>
                    <div class="controls">
                        <input type="text"
                               id="inputPassword2"
                               name="passwordConfirm"
                               password-confirm="inputPassword"
                               placeholder="confirm new password.."
                               ng-model="user.passwordConfirm" />
                        <span class="help-inline" ng-show="userForm.passwordConfirm.$error.passwordConfirm">Passwords do not match</span>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="inputCompany">Company</label>
                    <div class="controls">
                        <input type="text"
                               id="inputCompany"
                               placeholder="Company.."
                               ng-model="user.company" />
                    </div>
                </div>

                <div class="control-group" ng-class="{error: userForm.phoneNumber.$invalid}">
                    <label class="control-label" for="inputPhoneNumber">Phone Number</label>
                    <div class="controls">
                        <input type="text"
                               id="inputPhoneNumber"
                               name="phoneNumber"
                               placeholder="eg. 0412345678.."
                               ng-model="user.phoneNumber"
                               ng-pattern="/([0-9]+)/"
                               tooltip-placement="right"
                               tooltip="Phone Numbers can be used to send instant notifications." />
                        <span class="help-inline" ng-show="userForm.phoneNumber.$error.pattern">Phone numbers may only contain numbers</span>
                    </div>
                </div>

                <div class="control-group" ng-class="{error: userForm.role.$invalid}">
                    <label class="control-label" for="inputRole">Role</label>
                    <div class="controls">
                        <select id="inputRole"
                                ng-model="user.role"
                                name="role"
                                ng-options="o.id as o.name for o in options.roles"
                                required>
                        </select>
                        <span class="help-inline" ng-show="userForm.role.$error.required">A role must be selected</span>
                    </div>
                </div>
                <div class="control-group" ng-class="{error: userForm.client.$invalid}">
                    <label class="control-label" for="inputClient">Default Client</label>
                    <div class="controls">
                        <select id="inputClient"
                                ng-model="user.client"
                                name="client"
                                ng-options="o.id as o.name for o in options.clients"
                                required>
                        </select>
                        <span class="help-inline" ng-show="userForm.client.$error.required">A client must be selected</span>
                    </div>
                </div>

                <div class="control-group" ng-show="{{user.deleted}}">
                    <label class="control-label" for="inputNotifyEmail">Deleted</label>
                    <div class="controls">
                        <input type="checkbox"
                               id="inputDeleted"
                               ng-model="user.deleted" />
                        <span class="help-inline">Uncheck and save to restore this users account.</span>
                    </div>
                </div>

                <!-- Save -->
                <div class="control-group">
                    <div class="controls">
                        <button type="submit" name="submitButton" class="btn btn-success" ng-disabled="userForm.$invalid"><i class="icon icon-ok"></i> Save Changes</button>
                        <button type="button" class="btn btn-danger" ng-click="deleteUser()" ng-show="!{{user.deleted}}" ng-confirm-click="Are you sure you want to delete this user?"><i class="icon icon-remove"></i> Delete User</button>
                    </div>
                </div>
            </div>
        </div>

        <h2>User Notifications</h2>

        <div class="row-fluid">
            <div class="span12 form-horizontal">
                <p>Select the types of instant notifications this user will receive</p>
                <div class="control-group">
                    <label class="control-label" for="inputNotifyEmail">Email Notifications</label>
                    <div class="controls">
                        <input type="checkbox"
                               id="inputNotifyEmail"
                               ng-model="user.notifications.types.email" />
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="inputNotifyPhone">SMS Notifications</label>
                    <div class="controls">
                        <input type="checkbox"
                               id="inputNotifyPhone"
                               ng-model="user.notifications.types.phone"
                               tooltip-placement="right"
                               tooltip="SMS Notifications can issued for high severity events." />
                    </div>
                </div>
            </div>
        </div>

        <!-- Notify -->
        <div class="alert alert-info">
            <strong>Note:</strong> The notification criteria is inclusive; you will receive alerts for logs that match ANY of the items selected in the criteria below.
            <br/>For instance, selecting <strong>"NSW" <u>and</u> "VIC"</strong> would result in an alert being sent for any log that affects <strong>"NSW" <u>or</u> "VIC"</strong>.
        </div>

        <!-- Client One -->
        <div class="row-fluid" ng-repeat="client in options.notifications.clients">
            <div class="span12">
                <h2>{{client.name}}</h2>
                <div class="row-fluid">
                    <div class="span4">
                        <p>Send alerts for logs which are..</p>
                        <div class="control-group">
                            <div class="controls">
                                <label class="checkbox" ng-repeat="severity in client.severities">
                                    <input type="checkbox" ng-model="user.notifications.clients[client.id].severity[severity.id]"> {{severity.name}}
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="span8">
                        <div ng-repeat="group in client.attributes" id="hf2">
                            <div class="row-fluid">
                                <div class="span12">
                                    <legend>{{ group.name }}</legend>
                                </div>
                            </div>
                            <div class="row-fluid">
                                <div class="span6" ng-repeat="child in group.children">
                                    <span hierarchy-fields="{{child}}" hierarchy-selected="{{user.notifications.clients[client.id].attributes}}"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row-fluid">
            <div class="offset1 span11">

                <!-- Save -->
                <div class="control-group">
                    <div class="controls">
                        <button type="submit" class="btn btn-success" ng-disabled="userForm.$invalid"><i class="icon icon-ok"></i> Save Changes</button>
                        <button type="button" class="btn btn-danger" ng-show="!{{user.deleted}}" ng-click="deleteUser()" ng-confirm-click="Are you sure you want to delete this user?"><i class="icon icon-remove"></i> Delete User</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

</form>